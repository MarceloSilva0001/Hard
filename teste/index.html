<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>OiMenu - Servidor Offline</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="navbar">
      <div class="navbar-title">Servidor Offline Clientes - Suporte</div>
    </div>

    <div class="panel">
      <div class="panel-body">
        <input type="text" id="enderecoInput" placeholder="Digite o endereço">
        <input type="text" id="nomeInput" placeholder="Digite o nome">
        <button onclick="adicionarEntrada()">Adicionar</button>
      </div>
    </div>

    <div class="panel">
      <div class="panel-body">
        <p id="user"></p>  
      </div>
    </div>

    
    <script>
      var s = [];

      function carregarDados() {
        fetch('dados.txt')
          .then(response => response.text())
          .then(data => {
            s = JSON.parse(data);
            atualizarTabela();
          })
          .catch(error => console.error(error));
      }

      function salvarDados() {
        var data = JSON.stringify(s);
        var blob = new Blob([data], {type: 'text/plain'});

        // Solicita ao usuário que escolha o diretório de destino
        var a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'dados.txt';
        a.setAttribute('directory', 'C:/Users/Oi Menu suporte/Documents/MARCELO/CURSOS/projetos/teste'); // Substitua pelo diretório desejado
        a.setAttribute('nwworkingdir', 'C:/Users/Oi Menu suporte/Documents/MARCELO/CURSOS/projetos/teste'); // Substitua pelo diretório desejado
        a.click();
      }

      function atualizarTabela() {
        var text = '<table class="table table-striped">';
        for (var x in s) {
          text += '<tr><td><a href="' + s[x].endereco + '"><div class="table-text">' + s[x].nome + '<div></td></tr>';
        }
        text += "</table>";    
        document.getElementById("user").innerHTML = text;
      }

      function adicionarEntrada() {
        var endereco = document.getElementById("enderecoInput").value;
        var nome = document.getElementById("nomeInput").value;

        var novaEntrada = {
          "endereco": endereco,
          "nome": nome
        };

        s.push(novaEntrada);

        atualizarTabela();

        document.getElementById("enderecoInput").value = "";
        document.getElementById("nomeInput").value = "";

        salvarDados();
      }

      document.addEventListener("DOMContentLoaded", carregarDados);
    </script>
  </body>
</html>
